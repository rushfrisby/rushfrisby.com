<!doctype html>
<html lang="en">
    <head>
        <title>Rush Frisby</title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="/css/bootstrap.min.css" />
        <link rel="stylesheet" href="/css/site.css" />
    </head>
    <body>
        <div class="container-fluid p-0" id="header">
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <div class="container">
                    <a class="navbar-brand" href="/">Rush Frisby</a>
                    <button class="navbar-toggler" type="button" onclick="document.getElementById('navbar-toggle').checked = !document.getElementById('navbar-toggle').checked; return false;">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <input type="checkbox" id="navbar-toggle" style="display: none;">
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a class="nav-link" href="/">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/about">About</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/keyboards">Keyboards</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/tags">Tags</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/archive">Archive</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
            
        <div class="container">
            <div class="row" id="main">
                    <div class="col-md-9">

<article>
    <h2>Run SQL Query and Email Results</h2>
    <time datetime="6/6/2014 8:51:40 PM -04:00">Published on Sat, 07 Jun 2014 00:51:40 GMT</time>
    <div class="content">
        <p>The program below will run a SQL script, convert the results to an HTML table, and email you with it. Everything is passed in via command line parameters which makes it great for running on the fly from a batch file or as a scheduled task. Here is how you use it:</p>
<p>Usage:</p>
<p>sql_emailer.exe <script> <title> <email> <conn></p>
<p>Parameters:</p>
<ol>
<li><strong>script</strong> – Path to a SQL script which contains the query to be run.</li>
<li><strong>title</strong> – will be used as the email subject and header within the body.</li>
<li><strong>email</strong> – A single email address or comma delimited list of email addresses to send the query results to.</li>
<li><strong>conn</strong> – A reference to an appSettings key in the config file which contains the connection string of the database to connect to. If this parameter is omitted then “DefaultConnectionString” is used.</li>
</ol>
<p>In the config file you will need to add the appropriate appSettings keys with connection strings to your database(s). You will also need to configure the SMTP section in the config with your SMTP server settings.</p>
<p>[sdm_download id=”4501″ fancy=”0″]</p>
<div></div>Here is the source code minus the table styling from the exe:  
<script src="https://gist.github.com/rushfrisby/1d0430d1335f9ce6e446.js"></script>

    </div>
    <div class="tags">
        Tags: <a href="/tag/c">c</a> <a href="/tag/applications">applications</a> <a href="/tag/reporting">reporting</a> <a href="/tag/email">email</a>
    </div>
</article>
                </div>
                <div class="col-md-3">
                    <div class="card text-white bg-secondary mb-3">
                        <h5 class="card-header">Recent Posts</h5>
                        <div class="list-group list-group-flush">
                            <div class="list-group">
                                <a href="/interfacerpc-20" class="list-group-item list-group-item-action">InterfaceRpc 2.0</a>
                                <a href="/interface-to-rpc-service" class="list-group-item list-group-item-action">Interface to RPC Service</a>
                                <a href="/losing-our-memory" class="list-group-item list-group-item-action">Losing Our Memory</a>
                                <a href="/are-coding-bootcamps-worth-it" class="list-group-item list-group-item-action">Are Coding Bootcamps Worth It?</a>
                                <a href="/meetup-using-protobuf-in-net" class="list-group-item list-group-item-action">Meetup: Using Protobuf in .NET</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" id="footer">
                <div class="col">
                    <p>Proudly <a href="https://github.com/rushfrisby/RushBlog" target="_blank">published with my own blog engine on github</a></p>
                </div>
            </div>
        </div>
    </body>
</html>
